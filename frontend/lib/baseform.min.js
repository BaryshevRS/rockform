!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.form.min"],t):t("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(t){"use strict";t=t.noConflict(!0);var e="rockform",o={init:function(e,n){if(n.length>0)o.set({el:e,err_msg:n}),t(window).on("resize",{el:e,err_msg:n},o.set);else{var i=e.attr("name");i&&t('[data-bf-tooltip-id="'+i+'"]').remove()}},set:function(e){var o,n;if(e.data?(o=e.data.el,n=e.data.err_msg):(o=e.el,n=e.err_msg),o.attr("name")){var i=20,a=o.attr("name");t('[data-bf-tooltip-id="'+a+'"]').remove();var f=o.offset(),r=o.outerHeight(),s=o.outerWidth();o.after('<div class="bf-tooltip" data-bf-tooltip-id="'+a+'">                          <div class="bf-arrow"></div>'+n+"</div>");var d=t('[data-bf-tooltip-id="'+a+'"]'),c=d.outerWidth(),u=f.left+s/4*3,l=u+c+i,m=t(window).outerWidth()-i-c;l>t(window).outerWidth()&&(u=m),m<=f.left&&(u=f.left,d.width(s-i)),d.offset({top:f.top+r,left:u})}},reset:function(){t(window).off("resize",o.set),t(".bf-tooltip").remove()},position:function(e,o){t("form",e)}},n={server:function(e,i){var a,r,s=0;return o.reset(),t(".bf-status").remove(),i.mail_to?(e.before('<div class="bf-status bf-status-0">'+i.mail_to+"</div>"),!1):(t.each(i,function(d,c){a="","token"==d?f.set_attr_form(e,i.token,"bf-token"):(a=n.set_err_msg(c),r=t('[name="'+d+'"]'),r&&o.init(r,a),a.length>0&&(s=1))}),!(parseInt(s)>0))},set_err_msg:function(e){var o="";return e.required?o=e.required:e.rangelength?o=e.rangelength:e.minlength?o=e.minlength:e.maxlength?o=e.maxlength:t.each(e,function(t,e){return"required"!=t&&"rangelength"!=t&&"minlength"!=t&&"maxlength"!=t?(o=e,!1):void 0}),o}},i={init:function(e,o,n,a){t.ajax({url:e,data:o,method:"post",dataType:"html",beforeSend:function(t){i.loader_on()},success:function(e){i.set_overlay(),i.set_close_event(),t(".bf-modal, .bf-fixed-overlay").css("opacity","0"),t(".bf-modal-box").html(e),i.loader_off(),t(".bf-modal, .bf-fixed-overlay").animate({opacity:"1"},400),n(a)}})},set_overlay:function(){t("body").append('<div class="bf-fixed-overlay bf-fixed-overlay__modal">                             <div class="bf-modal">                                 <div class="bf-modal_container">                                     <a href="javascript:;" class="bf-modal-close" title=""></a>                                       <div class="bf-modal-box"></div>                                 </div>                             </div>                         </div>')},loader_on:function(){t("body").append('<div class="bf-loading"></div>')},loader_off:function(){t(".bf-loading").remove()},set_close_event:function(){t(".bf-modal-close, .bf-fixed-overlay").one("click",function(){t(".bf-fixed-overlay").remove(),f.init_form()}),t(".bf-modal").on("click",function(t){t.stopImmediatePropagation()})}},a={init:function(){var e=t('[data-bf-capcha=""]');e.off(),a.update(),e.on("click",function(){a.update()})},update:function(){t('[data-bf-capcha=""]').attr("src",f.path+"?type=capcha&u="+Math.random())}},f={config:"",path:"/"+e+"/init.php",init:function(){f.init_popup_form(),f.init_form()},init_popup_form:function(){t("[data-bf-config]").on("click",function(e){e.preventDefault(),o.reset();var n=t(this).data("bf-config");("undefined"==typeof n||n.length<1)&&(n="");var a=f.get_custom_popup_attributes(t(this));i.init(f.path,{"bf-config":n,attributes:a,type:"form"},f.init_form,{config_popup:n,attributes:a})}),t("form[data-bf-config]").off()},get_custom_popup_attributes:function(e){var o={},n="";return e.length&&t.each(e[0].attributes,function(t,e){n=e.name,/data\-bf\-field/.test(n)&&(n=n.replace("data-bf-",""),o[n]=e.value)}),o.field_page_h1=t("h1").html(),o.field_page_link=document.location.href,o},init_form:function(e){a.init(),t("form[data-bf-config], .bf-modal form").off("submit"),t("form[data-bf-config], .bf-modal form").on("submit",function(o){o.preventDefault();var i=t(this);"undefined"==typeof e&&(e={},e.config_popup=""),f.config=f.get_config(e.config_popup,i.data("bf-config"));var a=i.formToArray();t.each(a,function(t,e){"file"==e.type&&(a[t].value=e.value.name)}),t.post(f.path,{fields:a,type:"validation","bf-config":f.config},function(o){t(".bf-attr").remove(),f.set_attr_form(i,f.config,"bf-config"),n.server(i,o)&&("undefined"!=typeof e.attributes&&(t(".bf-attr").remove(),t.each(e.attributes,function(t,e){f.set_attr_form(i,e,t)})),i.ajaxSubmit({success:f.show_response,url:f.path,type:"post",dataType:"json"}))})})},set_attr_form:function(t,e,o){t.prepend('<input name="bf-config" class="bf-attr" type="hidden" value="'+e+'" />')},get_config:function(t,e){return"undefined"==typeof t||t.length<1?("undefined"==typeof e||e.length<1)&&(e=""):e=t,e},show_response:function(e,o,n,i){t(".bf-status").remove(),i.before('<div class="bf-status bf-status-'+e.status+'">'+e.value+"</div>"),e.status>0&&(i.hide(),setTimeout(function(){t(".bf-modal-close").click()},2e3),setTimeout(function(){i.show(),t(".bf-status").remove(),i.clearForm()},3e3))}};f.init()});